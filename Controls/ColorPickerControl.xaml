<UserControl x:Class="CrosshairOverlay.Controls.ColorPickerControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Width="380" Height="340"
             SizeChanged="UserControl_SizeChanged">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="200"/>
            <RowDefinition Height="20"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="100"/>
        </Grid.ColumnDefinitions>
        
        <!-- Top section: Color square, Hue slider, and Preview -->
        <Grid Grid.Row="0" Grid.Column="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="25"/>
            </Grid.ColumnDefinitions>
            
            <!-- Saturation/Value Square -->
            <Border Grid.Column="0" CornerRadius="8" ClipToBounds="True">
                <Canvas x:Name="SatValSquare" 
                        MouseLeftButtonDown="SatValSquare_MouseLeftButtonDown"
                        MouseMove="SatValSquare_MouseMove"
                        MouseLeftButtonUp="SatValSquare_MouseLeftButtonUp"
                        Cursor="Cross">
                    <Canvas.Background>
                        <!-- Base hue color -->
                        <SolidColorBrush x:Name="HueColorBrush" Color="Red"/>
                    </Canvas.Background>
                    
                    <!-- White to transparent gradient (left to right = saturation) -->
                    <Canvas.OpacityMask>
                        <DrawingBrush>
                            <DrawingBrush.Drawing>
                                <DrawingGroup>
                                    <GeometryDrawing>
                                        <GeometryDrawing.Geometry>
                                            <RectangleGeometry Rect="0,0,1,1"/>
                                        </GeometryDrawing.Geometry>
                                        <GeometryDrawing.Brush>
                                            <SolidColorBrush Color="White"/>
                                        </GeometryDrawing.Brush>
                                    </GeometryDrawing>
                                </DrawingGroup>
                            </DrawingBrush.Drawing>
                        </DrawingBrush>
                    </Canvas.OpacityMask>
                    
                    <!-- Saturation overlay: white to transparent (horizontal) -->
                    <Rectangle x:Name="SaturationOverlay" 
                               Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=Canvas}}"
                               Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Canvas}}">
                        <Rectangle.Fill>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="White" Offset="0"/>
                                <GradientStop Color="Transparent" Offset="1"/>
                            </LinearGradientBrush>
                        </Rectangle.Fill>
                    </Rectangle>
                    
                    <!-- Value overlay: transparent to black (vertical) -->
                    <Rectangle x:Name="ValueOverlay"
                               Width="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=Canvas}}"
                               Height="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=Canvas}}">
                        <Rectangle.Fill>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                <GradientStop Color="Transparent" Offset="0"/>
                                <GradientStop Color="Black" Offset="1"/>
                            </LinearGradientBrush>
                        </Rectangle.Fill>
                    </Rectangle>
                    
                    <!-- Selection indicator -->
                    <Ellipse x:Name="SatValIndicator" Width="16" Height="16" 
                             Stroke="White" StrokeThickness="2" Fill="Transparent"
                             IsHitTestVisible="False">
                        <Ellipse.Effect>
                            <DropShadowEffect ShadowDepth="0" BlurRadius="3" Color="Black"/>
                        </Ellipse.Effect>
                    </Ellipse>
                </Canvas>
            </Border>
            
            <!-- Hue Slider (Cylinder style) -->
            <Border Grid.Column="2" CornerRadius="20" ClipToBounds="True">
                <Canvas x:Name="HueSlider"
                        MouseLeftButtonDown="HueSlider_MouseLeftButtonDown"
                        MouseMove="HueSlider_MouseMove"
                        MouseLeftButtonUp="HueSlider_MouseLeftButtonUp"
                        Cursor="Hand">
                    <Canvas.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#FF0000" Offset="0.000"/>
                            <GradientStop Color="#FFFF00" Offset="0.167"/>
                            <GradientStop Color="#00FF00" Offset="0.333"/>
                            <GradientStop Color="#00FFFF" Offset="0.500"/>
                            <GradientStop Color="#0000FF" Offset="0.667"/>
                            <GradientStop Color="#FF00FF" Offset="0.833"/>
                            <GradientStop Color="#FF0000" Offset="1.000"/>
                        </LinearGradientBrush>
                    </Canvas.Background>
                    
                    <!-- Hue indicator (horizontal bar) -->
                    <Border x:Name="HueIndicator" Width="29" Height="10" 
                            Background="Transparent" BorderBrush="White" BorderThickness="2"
                            CornerRadius="5" Canvas.Left="-2" IsHitTestVisible="False">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="0" BlurRadius="3" Color="Black"/>
                        </Border.Effect>
                    </Border>
                </Canvas>
            </Border>
        </Grid>
        
        <!-- Color preview square -->
        <Border Grid.Row="0" Grid.Column="1" 
                Width="80" Height="80" CornerRadius="8"
                BorderBrush="#333333" BorderThickness="2"
                HorizontalAlignment="Center" VerticalAlignment="Center"
                Margin="10,0,0,0">
            <Border.Background>
                <SolidColorBrush x:Name="PreviewBrush" Color="Red"/>
            </Border.Background>
        </Border>
        
        <!-- HSV Sliders section -->
        <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" VerticalAlignment="Top">
            <!-- Hue Slider Row -->
            <Grid Margin="0,5,0,5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="25"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="50"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="H" Foreground="#888888" FontSize="14" FontWeight="Bold" VerticalAlignment="Center"/>
                <Border Grid.Column="1" Height="10" CornerRadius="5" Margin="10,0">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                            <GradientStop Color="#FF0000" Offset="0.000"/>
                            <GradientStop Color="#FFFF00" Offset="0.167"/>
                            <GradientStop Color="#00FF00" Offset="0.333"/>
                            <GradientStop Color="#00FFFF" Offset="0.500"/>
                            <GradientStop Color="#0000FF" Offset="0.667"/>
                            <GradientStop Color="#FF00FF" Offset="0.833"/>
                            <GradientStop Color="#FF0000" Offset="1.000"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Slider Grid.Column="1" x:Name="HueSliderControl" 
                        Minimum="0" Maximum="360" 
                        Value="0" 
                        ValueChanged="HueSliderControl_ValueChanged"
                        Margin="10,0" VerticalAlignment="Center"
                        Background="Transparent"/>
                <TextBlock Grid.Column="2" x:Name="HueValueText" Text="0Â°" 
                           Foreground="#CCCCCC" FontSize="13" 
                           HorizontalAlignment="Right" VerticalAlignment="Center"/>
            </Grid>
            
            <!-- Saturation Slider Row -->
            <Grid Margin="0,5,0,5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="25"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="50"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="S" Foreground="#888888" FontSize="14" FontWeight="Bold" VerticalAlignment="Center"/>
                <Border Grid.Column="1" x:Name="SaturationTrack" Height="10" CornerRadius="5" Margin="10,0">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                            <GradientStop Color="White" Offset="0"/>
                            <GradientStop x:Name="SaturationEndColor" Color="Red" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Slider Grid.Column="1" x:Name="SaturationSliderControl" 
                        Minimum="0" Maximum="100" 
                        Value="100" 
                        ValueChanged="SaturationSliderControl_ValueChanged"
                        Margin="10,0" VerticalAlignment="Center"
                        Background="Transparent"/>
                <TextBlock Grid.Column="2" x:Name="SaturationValueText" Text="100%" 
                           Foreground="#CCCCCC" FontSize="13" 
                           HorizontalAlignment="Right" VerticalAlignment="Center"/>
            </Grid>
            
            <!-- Value/Brightness Slider Row -->
            <Grid Margin="0,5,0,5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="25"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="50"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="V" Foreground="#888888" FontSize="14" FontWeight="Bold" VerticalAlignment="Center"/>
                <Border Grid.Column="1" x:Name="ValueTrack" Height="10" CornerRadius="5" Margin="10,0">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                            <GradientStop Color="Black" Offset="0"/>
                            <GradientStop x:Name="ValueEndColor" Color="Red" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
                <Slider Grid.Column="1" x:Name="ValueSliderControl" 
                        Minimum="0" Maximum="100" 
                        Value="100" 
                        ValueChanged="ValueSliderControl_ValueChanged"
                        Margin="10,0" VerticalAlignment="Center"
                        Background="Transparent"/>
                <TextBlock Grid.Column="2" x:Name="ValueValueText" Text="100%" 
                           Foreground="#CCCCCC" FontSize="13" 
                           HorizontalAlignment="Right" VerticalAlignment="Center"/>
            </Grid>
        </StackPanel>
    </Grid>
</UserControl>
